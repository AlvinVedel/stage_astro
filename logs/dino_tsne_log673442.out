-----------------------------------------------------------------------------------------------------------------------------------
IDRIS WARNING: if you encounter performance issues regarding CPU multithreading, please consider loading one the following modules:
  tensorflow-gpu/py3/2.4.0-noMKL
  tensorflow-gpu/py3/2.5.0+nccl-2.8.3
  tensorflow-gpu version >= 2.6.0
-----------------------------------------------------------------------------------------------------------------------------------

Loading tensorflow-gpu/py3/2.4.1
  Loading requirement: gcc/8.5.0 cuda/10.2 nccl/2.6.4-1-cuda
    cudnn/8.0.4.30-cuda-10.2 openmpi/4.0.2-cuda
+ python -u dino_features.py
2024-11-12 10:36:26.885438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.2
FILE  0 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0169_phot.npz
FILE  0 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0379_photo_D.npz
FILE  0 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0326_photo_UD.npz
FILE  1 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0154_phot.npz
FILE  1 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0383_photo_D.npz
FILE  1 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0317_photo_UD.npz
FILE  2 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0071_phot.npz
FILE  2 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0271_photo_D.npz
FILE  2 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0346_photo_UD.npz
FILE  3 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0102_phot.npz
FILE  3 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0055_photo_D.npz
FILE  3 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0350_photo_UD.npz
FILE  4 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0120_phot.npz
FILE  4 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0032_photo_D.npz
FILE  4 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0324_photo_UD.npz
FILE  5 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0236_phot.npz
FILE  5 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0085_photo_D.npz
FILE  5 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0366_photo_UD.npz
FILE  6 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0058_phot.npz
FILE  6 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0307_photo_D.npz
FILE  6 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0285_photo_UD.npz
FILE  7 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0091_phot.npz
FILE  7 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0245_photo_D.npz
FILE  7 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0303_photo_UD.npz
FILE  8 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0098_phot.npz
FILE  8 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0150_photo_D.npz
FILE  8 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0069_photo_UD.npz
FILE  9 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0244_phot.npz
FILE  9 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0216_photo_D.npz
FILE  9 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0276_photo_UD.npz
FILE  10 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0022_phot.npz
FILE  10 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0391_photo_D.npz
FILE  10 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0338_photo_UD.npz
FILE  11 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0191_phot.npz
FILE  11 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0409_photo_D.npz
FILE  11 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0213_photo_UD.npz
FILE  12 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0234_phot.npz
FILE  12 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0197_photo_D.npz
FILE  12 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0296_photo_UD.npz
FILE  13 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0147_phot.npz
FILE  13 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0214_photo_D.npz
FILE  13 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0293_photo_UD.npz
FILE  14 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0243_phot.npz
FILE  14 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0229_photo_D.npz
FILE  14 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0292_photo_UD.npz
FILE  15 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0067_phot.npz
FILE  15 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0238_photo_D.npz
FILE  15 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0230_photo_UD.npz
FILE  16 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0130_phot.npz
FILE  16 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0127_photo_D.npz
FILE  16 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0049_photo_UD.npz
FILE  17 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0078_phot.npz
FILE  17 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0090_photo_D.npz
FILE  17 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0313_photo_UD.npz
FILE  18 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0219_phot.npz
FILE  18 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0099_photo_D.npz
FILE  18 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0286_photo_UD.npz
FILE  19 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0245_phot.npz
FILE  19 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0277_photo_D.npz
FILE  19 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0141_photo_UD.npz
FILE  20 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0116_phot.npz
FILE  20 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0025_photo_D.npz
FILE  20 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0332_photo_UD.npz
FILE  21 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0096_phot.npz
FILE  21 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0293_photo_D.npz
FILE  21 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0222_photo_UD.npz
FILE  22 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0112_phot.npz
FILE  22 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0234_photo_D.npz
FILE  22 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0318_photo_UD.npz
FILE  23 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0132_phot.npz
FILE  23 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0200_photo_D.npz
FILE  23 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0282_photo_UD.npz
FILE  24 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0110_phot.npz
FILE  24 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0278_photo_D.npz
FILE  24 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0357_photo_UD.npz
FILE  25 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0240_phot.npz
FILE  25 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0131_photo_D.npz
FILE  25 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0073_photo_UD.npz
FILE  26 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0185_phot.npz
FILE  26 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0213_photo_D.npz
FILE  26 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0308_photo_UD.npz
FILE  27 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/DEEP2/DEEP2_v11_ui_0087_phot.npz
FILE  27 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0276_photo_D.npz
FILE  27 /lustre/fswork/projects/rech/kof/uve94ap/CUBES_HSC/PHOT/COSMOS/COSMOS_v11_uijk_0361_photo_UD.npz
2024-11-12 10:42:14.987707: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-12 10:42:15.044390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-12 10:42:15.112283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:88:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.73GiB deviceMemoryBandwidth: 836.37GiB/s
2024-11-12 10:42:15.112772: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.2
2024-11-12 10:42:15.226425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-11-12 10:42:15.226533: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-11-12 10:42:15.301880: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-12 10:42:15.320869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-12 10:42:15.435116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-12 10:42:15.465046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-11-12 10:42:15.470393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-12 10:42:15.474336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-12 10:42:15.505584: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-12 10:42:15.521278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:88:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.73GiB deviceMemoryBandwidth: 836.37GiB/s
2024-11-12 10:42:15.521321: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.2
2024-11-12 10:42:15.521355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2024-11-12 10:42:15.521384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2024-11-12 10:42:15.521423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-12 10:42:15.521446: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-12 10:42:15.521467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-12 10:42:15.521487: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2024-11-12 10:42:15.521508: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-12 10:42:15.522005: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-12 10:42:15.523132: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.2
2024-11-12 10:42:17.096551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-12 10:42:17.098944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-12 10:42:17.100737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-12 10:42:17.151888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30120 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-32GB, pci bus id: 0000:88:00.0, compute capability: 7.0)
2024-11-12 10:42:17.169100: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-12 10:42:17.184149: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Traceback (most recent call last):
  File "dino_features.py", line 159, in <module>
    model.load_weights(w)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/tensorflow-gpu-2.4.1/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 2227, in load_weights
    with h5py.File(filepath, 'r') as f:
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/tensorflow-gpu-2.4.1/lib/python3.7/site-packages/h5py/_hl/files.py", line 408, in __init__
    swmr=swmr)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/tensorflow-gpu-2.4.1/lib/python3.7/site-packages/h5py/_hl/files.py", line 173, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 88, in h5py.h5f.open
OSError: Unable to open file (unable to open file: name = './teacher_backbone.weights.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
